name: Full Power Test Controller

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

# --- Ø¨Ø®Ø´ Ø­ÛŒØ§ØªÛŒ: Ø§Ø¹Ø·Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ú©Ø§Ù…Ù„ Ø¨Ù‡ Ø±Ø¨Ø§Øª Ø®ÙˆØ¯Ú©Ø§Ø± ---
permissions:
  contents: write      # Ø§Ø¬Ø§Ø²Ù‡ Ú©Ø§Ù…Ù„ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù†ØŒ Ù†ÙˆØ´ØªÙ†ØŒ ØªØºÛŒÛŒØ± Ùˆ Ø­Ø°Ù ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø¯Ø± Ù…Ø®Ø²Ù†
  pages: write         # Ø§Ø¬Ø§Ø²Ù‡ Ø§Ù†ØªØ´Ø§Ø± Ø³Ø§ÛŒØª
  id-token: write      # Ø§Ø¬Ø§Ø²Ù‡ Ø§Ù…Ù†ÛŒØªÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯

jobs:
  ultimate-execution:
    runs-on: ubuntu-latest
    
    steps:
      # Û±. Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù„ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ø§Ù…Ù„ ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø¹Ù…Ù„Ú©Ø±Ø¯ ØµØ­ÛŒØ­ Ú¯ÛŒØª

      # Û². Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…Ø­ÛŒØ· Ù¾Ø§ÛŒØªÙˆÙ†
      - name: Setup Python Environment
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      # Û³. Ù†ØµØ¨ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§ Ùˆ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ (Ø¯Ø§Ù†Ù„ÙˆØ¯ Ùˆ Ø¢Ù¾Ù„ÙˆØ¯ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§)
      - name: Install System & Python Dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y google-chrome-stable unzip
          pip install --upgrade pip
          pip install selenium webdriver-manager requests beautifulsoup4 lxml
          # Ø§Ú¯Ø± ÙØ§ÛŒÙ„ requirements.txt Ø¯Ø§Ø±ÛŒØ¯ØŒ Ø®Ø· Ø²ÛŒØ± Ø±Ø§ Ø§Ø² Ú©Ø§Ù…Ù†Øª Ø®Ø§Ø±Ø¬ Ú©Ù†ÛŒØ¯:
          # pip install -r requirements.txt

      # Û´. Ø§Ø¬Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù¾Ø§ÛŒØªÙˆÙ† Ø¨Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù…Ø­ÛŒØ·
      # ÙØ§ÛŒÙ„ setup.py Ø§Ú©Ù†ÙˆÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù‡Ø± ÙØ§ÛŒÙ„ÛŒ Ø±Ø§ Ø¨Ø®ÙˆØ§Ù†Ø¯ØŒ Ø¨Ù†ÙˆÛŒØ³Ø¯ ÛŒØ§ Ù¾Ø§Ú© Ú©Ù†Ø¯
      - name: Run Python Script (setup.py)
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # ØªÙˆÚ©Ù† Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ Ø¯Ø§Ø®Ù„ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª
        run: python setup.py

      # Ûµ. Ø°Ø®ÛŒØ±Ù‡ ØªÙ…Ø§Ù… ØªØºÛŒÛŒØ±Ø§Øª (Ø­Ø°ÙÛŒØ§ØªØŒ Ø§Ø¶Ø§ÙØ§Øª Ùˆ ÙˆÛŒØ±Ø§ÛŒØ´â€ŒÙ‡Ø§)
      - name: Commit and Push All Changes
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          
          # Ø¯Ø³ØªÙˆØ± Ø²ÛŒØ± (-A) ÛŒØ¹Ù†ÛŒ: ØªÙ…Ø§Ù… ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ØŒ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡ Ùˆ Ø­Ø°Ù Ø´Ø¯Ù‡ Ø±Ø§ Ø¨Ù‡ Ù„ÛŒØ³Øª Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
          git add -A
          
          # Ø§Ú¯Ø± ØªØºÛŒÛŒØ±ÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªØŒ Ú©Ø§Ù…ÛŒØª Ú©Ù† Ùˆ Ø¨ÙØ±Ø³Øª
          git commit -m "ğŸ¤– Auto-update: Applied changes from setup.py" || echo "No changes found to commit"
          git push origin HEAD:main

      # Û¶. Ø§Ù†ØªØ´Ø§Ø± Ù†Ù‡Ø§ÛŒÛŒ Ø¯Ø± Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ Ù¾ÛŒØ¬
      - name: Deploy Result to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: .    # Ø§Ù†ØªØ´Ø§Ø± Ú©Ù„ Ù…Ø­ØªÙˆÛŒØ§Øª ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡
          clean: true
          branch: gh-pages
